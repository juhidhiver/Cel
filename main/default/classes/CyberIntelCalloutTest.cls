@isTest
public class CyberIntelCalloutTest {
    
    public class CyberIntelMockResponse implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {        
            HttpResponse res = new HttpResponse();
            res.setHeader('Content-Type', 'application/json');
            //res.setBody('{"average_score":"762"}');
            res.setBody('{"primary_domain":"cintra.com","rating_details":{"botnet_infections":{"name":"Botnet Infections","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Compromised Systems","category_order":0,"beta":false,"order":0},"spam_propagation":{"name":"Spam Propagation","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Compromised Systems","category_order":0,"beta":false,"order":1},"malware_servers":{"name":"Malware Servers","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Compromised Systems","category_order":0,"beta":false,"order":2},"unsolicited_comm":{"name":"Unsolicited Communications","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Compromised Systems","category_order":0,"beta":false,"order":3},"potentially_exploited":{"name":"Potentially Exploited","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Compromised Systems","category_order":0,"beta":false,"order":4},"spf":{"name":"SPF","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":5},"dkim":{"name":"DKIM","rating":710,"grade":"C","percentile":57,"grade_color":"#ecb870","category":"Diligence","category_order":1,"beta":false,"order":6},"ssl_certificates":{"name":"SSL Certificates","rating":810,"grade":"A","percentile":98,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":7},"ssl_configurations":{"name":"SSL Configurations","rating":810,"grade":"A","percentile":96,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":8},"open_ports":{"name":"Open Ports","rating":800,"grade":"B","percentile":91,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":9},"dnssec":{"name":"DNSSEC","rating":700,"grade":"C","percentile":53,"grade_color":"#ecb870","category":"Diligence","category_order":1,"beta":true,"order":10},"application_security":{"name":"Web Application Headers","rating":710,"grade":"C","percentile":60,"grade_color":"#ecb870","category":"Diligence","category_order":1,"beta":false,"order":11},"patching_cadence":{"name":"Patching Cadence","rating":580,"grade":"B","percentile":21,"grade_color":"#c77481","category":"Diligence","category_order":1,"beta":false,"order":12},"file_sharing":{"name":"File Sharing","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"User Behavior","category_order":2,"beta":false,"order":13},"insecure_systems":{"name":"Insecure Systems","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":15},"server_software":{"name":"Server Software","rating":800,"grade":"A","percentile":91,"grade_color":"#2c4d7f","category":"Diligence","category_order":1,"beta":false,"order":16},"desktop_software":{"name":"Desktop Software","rating":"N/A","grade":"N/A","percentile":"N/A","grade_color":"#495057","category":"Diligence","category_order":1,"beta":false,"order":17},"mobile_software":{"name":"Mobile Software","rating":"N/A","grade":"N/A","percentile":"N/A","grade_color":"#495057","category":"Diligence","category_order":1,"beta":false,"order":18},"data_breaches":{"name":"Security Incidents","rating":820,"grade":"A","percentile":100,"grade_color":"#2c4d7f","category":"Public Disclosures","category_order":3,"beta":false,"order":19},"mobile_application_security":{"name":"Mobile Application Security","rating":"N/A","grade":"N/A","percentile":"N/A","grade_color":"#495057","category":"Diligence","category_order":1,"beta":true,"order":20}},"ratings":[{"rating_date":"2021-03-28","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-27","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-26","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-25","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-24","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-23","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-22","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-21","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-20","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-19","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-18","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-17","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-16","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-15","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-14","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-13","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-12","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-11","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-10","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-09","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-08","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-07","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-06","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-05","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-04","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-03","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-02","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-03-01","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-28","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-27","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-26","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-25","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-24","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-23","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-22","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-21","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-20","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-19","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-18","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-17","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-16","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-15","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-14","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-13","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-12","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-11","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-10","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-09","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-08","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-07","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-06","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-05","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-04","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-03","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-02","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-02-01","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-31","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-30","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-29","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-28","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-27","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-26","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-25","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-24","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-23","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-22","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-21","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-20","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-19","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-18","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-17","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-16","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-15","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-14","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-13","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-12","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-11","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-10","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-09","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-08","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-07","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-06","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-05","rating":760,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2021-01-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-31","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-12-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-11-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-31","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-10-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-09-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-31","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-08-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-31","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-07-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-11","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-10","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-09","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-08","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-07","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-06","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-05","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-04","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-03","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-02","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-06-01","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-31","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-30","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-29","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-28","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-27","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-26","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-25","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-24","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-23","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-22","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-21","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-20","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-19","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-18","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-17","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-16","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-15","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-14","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-13","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-12","rating":750,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-11","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-10","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-09","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-08","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-07","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-06","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-05","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-04","rating":740,"range":"Advanced","rating_color":"#2c4d7f"},{"rating_date":"2020-05-03","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-05-02","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-05-01","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-30","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-29","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-28","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-27","rating":730,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-26","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-25","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-24","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-23","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-22","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-21","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-20","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-19","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-18","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-17","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-16","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-15","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-14","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-13","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-12","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-11","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-10","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-09","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-08","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-07","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-06","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-05","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-04","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-03","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-02","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-04-01","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-03-31","rating":720,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-03-30","rating":710,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-03-29","rating":710,"range":"Intermediate","rating_color":"#e8a951"},{"rating_date":"2020-03-28","rating":710,"range":"Intermediate","rating_color":"#e8a951"}],"quota_details":{"quota_purchased":4000,"quota_used":2056,"quota_available":1944},"average_score":751}');
            res.setStatusCode(200);
            return res;
        }
    }
    
    @testSetup static void setup(){
        Id recordTypeId = Schema.SObjectType.Account.getRecordTypeInfosByDeveloperName().get('Business').getRecordTypeId();
        Account acc = TestUtil.createAccount('Account Test', recordTypeId, '123 Main Street', 'Anycity', 'New York', '11354', 'United States');
        acc.Website = 'chatterboxwinemarketing.com';
        insert acc;
        
        Product2 prod = TestUtil.createProduct('Cyber Standalone');
        prod.Model_ID__c = 'Celerity_Cyber';
        prod.IsActive = True;
        insert prod;
        
        Opportunity opp = TestUtil.createOpportunity('Opp Test',acc.Id, prod.Id);
        opp.Service_to_Run__c = 'Bit Sight';
        opp.StageName = 'New';
        insert opp;
        
        Rating_Modifiers__c rateMod = TestUtil.createRatingModifier('Cyber Intel Average Score', 'Cyber', opp.Id);
        insert rateMod;
        
        Rating_Modifiers__c rateMod2 = TestUtil.createRatingModifier('Cyber Intel Service', 'Cyber', opp.Id);
        insert rateMod2;
        
        Rating_Modifiers__c rateMod3 = TestUtil.createRatingModifier('Cyber Intel BitSight Rules', 'Cyber', opp.Id);
        insert rateMod3;
        
        Rating_Modifiers__c rateMod4 = TestUtil.createRatingModifier('Cyber Intel Failed Reason', 'Cyber', opp.Id);
        insert rateMod4;
        
        Rating_Modifiers__c rateMod5 = TestUtil.createRatingModifier('Cyber Intel Score', 'Cyber', opp.Id);
        insert rateMod5;
        
        CyberIntelCallout.Desktop_software desk = new  CyberIntelCallout.Desktop_software() ;
        desk.name = 'Test';
        desk.rating = '2 rate';
        desk.grade = 'A';
        desk.percentile = 'hundred';
        desk.grade_color = 'green';
        desk.category = 'TestCAT';
        desk.category_order = 2;
        desk.beta = true;
        desk.order = 1;
       
      
        
    }
    
    @isTest
    public static void sendSubmissionDetailsTest(){
        Test.startTest();
        
        Opportunity opp = [Select Id, Service_to_Run__c, StageName from Opportunity];
        Product2 prod = [Select Id from Product2 Where Name = 'Cyber Standalone'];
        
        CyberIntelMockResponse mock = new CyberIntelMockResponse();
        Test.setMock(HttpCalloutMock.class, mock);
        
        //Test.startTest();
        CyberIntelCallout.cyberIntelRequest(opp.Id);
        CyberIntelCallout.checkProductType(prod.Id);
        
        Rating_Modifiers__c rateMod2 = TestUtil.createRatingModifier('Cyber Intel Service', 'Cyber', opp.Id);
        insert rateMod2;
        
        opp.Service_to_Run__c = 'None';
        update opp;  
        
        CyberIntelCallout.cyberIntelRequest(opp.Id);
        
        System.assertEquals(null, [Select Rating_Modifier_Value__c FROM Rating_Modifiers__c WHERE
                                    Name = 'Cyber Intel Average Score'].Rating_Modifier_Value__c);
                Test.stopTest();
        
    }
    
    @isTest
    public static void testGetOppId(){
        Test.startTest();
        
        Opportunity opp = [Select Id, Service_to_Run__c, StageName, AccountId from Opportunity];
        CyberIntelCallout.getOppId(opp.Id);
        
        Quote_Process__c quoteProcess = new Quote_Process__c(Submission__c = opp.Id, Account__c = opp.AccountId, Status__c = 'Submission Info');
        insert quoteProcess;
        Opportunity oppFromCyberIntelCallout = CyberIntelCallout.getOppId(quoteProcess.Id);
        Test.stopTest();
        
        System.assertEquals('Bit Sight', oppFromCyberIntelCallout.Service_to_Run__c);
    }
     @isTest
    public static void sendSubmissionDetailsTest1(){
        Test.startTest();
        Account acc = [Select id from Account limit 1];
        Product2 prod = [Select Id from Product2 limit 1];
        Opportunity opp = TestUtil.createOpportunity('Opp Test',acc.Id, prod.Id);
        opp.Service_to_Run__c = 'Bit Sight';
        insert opp;
        
        //Opportunity opp = [Select Id, Service_to_Run__c, StageName from Opportunity];
     
        CyberIntelMockResponse mock = new CyberIntelMockResponse();
        Test.setMock(HttpCalloutMock.class, mock);
        
        //Test.startTest();
        Rating_Modifiers__c rateMod2 = TestUtil.createRatingModifier('Cyber Intel BitSight Rules', 'Cyber', opp.Id);
        rateMod2.Opportunity__c=opp.Id;
        insert rateMod2;
        
        rateMod2.Rating_Modifier_Value__c='Service Failed';
        //update rateMod2;
       
        CyberIntelCallout.CyberIntelWrapper cyber = new  CyberIntelCallout.CyberIntelWrapper();
        cyber.average_score = '700';
        cyber.primary_domain = 'primary';
        
        CyberIntelCallout.Rating_details rating = new CyberIntelCallout.Rating_details();
        CyberIntelCallout.RatingDetailsData data = new CyberIntelCallout.RatingDetailsData();
       
        //cyber.data.spam_propagation;        
        CyberIntelCallout.cyberIntelRequest(opp.Id);
          
        //System.assertEquals('Service Failed', [Select Rating_Modifier_Value__c FROM Rating_Modifiers__c WHERE
                                    //Name = 'Cyber Intel BitSight Rules'].Rating_Modifier_Value__c);
        
        Test.stopTest();
        
    }
    
    @isTest
    public static void sendSubmissionDetailsTest2(){
        Test.startTest();
        
        Opportunity opp = [Select Id, Service_to_Run__c, StageName from Opportunity];
        Product2 prod = [Select Id from Product2 Where Name = 'Cyber Standalone'];
        
        CyberIntelMockResponse mock = new CyberIntelMockResponse();
        Test.setMock(HttpCalloutMock.class, mock);
        
        //Test.startTest();
        CyberIntelCallout.cyberIntelRequest(opp.Id);
        CyberIntelCallout.checkProductType(prod.Id);
        
        Rating_Modifiers__c rateMod2 = TestUtil.createRatingModifier('Cyber Intel Service', 'Cyber', opp.Id);
        insert rateMod2;
        
        opp.Service_to_Run__c = 'None';
        update opp;  
        
        CyberIntelCallout.cyberIntelRequest(opp.Id);
        
      
                Test.stopTest();
        
    }
   
}